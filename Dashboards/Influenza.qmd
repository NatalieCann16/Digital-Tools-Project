---
title: "Influenza"
format: html
---

## Overall University Report for Influenza (Flu)

::: {.columns}
::: {.column width="60%"}
```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Load library
library(ggplot2)
library(dplyr)

# Create mock seasonal flu data for a university of ~40,000 students
set.seed(456)
flu_data <- data.frame(
  Date = seq.Date(from = as.Date("2025-01-01"), by = "month", length.out = 12)
) %>%
  mutate(
    Month = as.integer(format(Date, "%m")),
    # Flu peaks in winter (Decâ€“Feb), lower in spring/fall, minimal in summer
    Cases = case_when(
      Month %in% c(12, 1, 2) ~ sample(700:1000, 1),    # winter surge
      Month %in% c(3, 4, 5, 10, 11) ~ sample(400:700, 1), # shoulder seasons
      Month %in% c(6, 7, 8, 9) ~ sample(100:300, 1)    # summer lull
    )
  ) %>%
  mutate(
    Cumulative = cumsum(Cases)
  )

# Plot: monthly + cumulative (with area fill)
flu_plot <- ggplot(flu_data, aes(x = Date)) +
  geom_area(aes(y = Cumulative, fill = "Cumulative Cases"), alpha = 0.3) +
  geom_line(aes(y = Cumulative, color = "Cumulative Cases"), linewidth = 1.2) +
  geom_point(aes(y = Cumulative, color = "Cumulative Cases"), size = 3) +
  geom_line(aes(y = Cases, color = "Monthly Cases"), linewidth = 1.2) +
  geom_point(aes(y = Cases, color = "Monthly Cases"), size = 3) +
  labs(
    title = "Influenza (Flu) Cases (Monthly vs. Cumulative)",
    x = "Month of the Year (2025)",
    y = "Number of Cases",
    color = "",
    fill = ""
  ) +
  scale_x_date(date_breaks = "1 month", date_labels = "%B") +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5, size = 18),
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "bottom"
  ) +
  scale_color_manual(values = c("Monthly Cases" = "#78c2db", "Cumulative Cases" = "#84cdb5")) +
  scale_fill_manual(values = c("Cumulative Cases" = "#84cdb5"))

flu_plot
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Assume "active cases" ~ 25% of the most recent month's cases
active_cases_flu <- round(last(flu_data$Cases) * 0.25)

# Assume "past 72 hours" ~ 10% of the most recent month's cases
cases_72h_flu <- round(last(flu_data$Cases) * 0.10)

# Create a styled summary box
htmltools::tags$div(
  style = "margin-top:15px; padding:15px; border-radius:8px; 
           background-color:#f0f8ff; width:80%; 
           box-shadow:0 2px 5px rgba(0,0,0,0.1);",
  htmltools::tags$h4("November 15th, 2025, Summary (as of latest data)", style="font-weight:bold;"),
  htmltools::tags$p(paste("Active Cases:", format(active_cases_flu, big.mark=","))),
  htmltools::tags$p(paste("Cases in Past 72 Hours:", format(cases_72h_flu, big.mark=",")))
)
```
:::

::: {.column width="40%"}
```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(gt)

# Build the table
flu_table <- flu_data %>%
  mutate(Month_Name = format(Date, "%B")) %>%
  select(Month_Name, Cases, Cumulative)

# Create gt table
gt_flu <- flu_table %>%
  gt() %>%
  tab_header(title = "Monthly and Cumulative Flu Cases (2025)") %>%
  cols_label(
    Month_Name = "Month",
    Cases = "Monthly Cases",
    Cumulative = "Cumulative Cases"
  ) %>%
  fmt_number(columns = c(Cases, Cumulative), decimals = 0, use_seps = TRUE) %>%
  tab_options(
    table.font.size = px(14),
    table.width = pct(100),
    heading.title.font.size = px(18),
    heading.align = "center"
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_title(groups = "title")
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels(everything())
  ) %>%
  # Orange background for odd rows
  tab_style(
    style = cell_fill(color = "#E9F5F0"),
    locations = cells_body(rows = seq(1, nrow(flu_table), 2))
  ) %>%
  # Pale blue background for even rows
  tab_style(
    style = cell_fill(color = "#f0f8ff"),
    locations = cells_body(rows = seq(2, nrow(flu_table), 2))
  )

gt_flu
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Quick link box
htmltools::tags$div(
  style = "margin-top:15px; padding:10px; border-radius:6px; 
           background-color:#E9F5F0; width:100%; 
           box-shadow:0 2px 5px rgba(0,0,0,0.1); text-align:center;",
  htmltools::tags$a(
    href = "https://www.cdc.gov/flu/index.htm",
    target = "_blank",
    style = "color:black; font-weight:bold; text-decoration:none;",
    "Visit CDC Flu Page"
  )
)
```
:::

## About Influenza (Flu)

The information below in the infographic came from the Centers for Disease Control & Prevention. This information is not meant to replace seeking guidance from a healthcare provider. If you are feeling ill or have questions, please call your healthcare provider or the University Health Center.

![Influenza Infographic](Fluinfographic.png)
